from sage.all import GF, Matrix, vector
from Crypto.Util.number import long_to_bytes

p = 10580731215444436219213907263947534038012197972307836319229421193761088798378768844649759133142120180834573817149711299466707823017636232456526471274387917
Q = [6718668664591596190749745980002066645380242844394957953766947533978323053938214647829798301606252456858132121628517723050462291300790766055200866765561610, 8738840830394886495658505803088103824478963010774845789433253508554356383249611502157307334585157729703873877797759121271071421201959116272886732798936523]
R = [8922553268219903948421811612403588317187402276064169063400419617931637566221670948925221403527928336656976084021780421068421112325215152715630319708159148, 1960697234007608888633325436691320507012497445090151112947144246088597317322303593936974554881161091213718329061011703885436579261559669838148253146762736]
S = [4389820170235953517860364281419052587762385444517203945856665517072263529411621622474249480804818285716662154444854074939122170918939074730520091008754679, 10274488321950407401790238304858775303749809597573328350457719402010568443492374388509295355784873292280254116167747959663379913408799485392015111636115272]
C = [2312453804397990204892582347458673184184584053391181580849656202381982276483135032773767708029907426388840618138608941250788745829088238589339462137662516, 10523194306636352419831471584744199603299973937259007033119401866043123235256118686290774285411893111835433604432082195914308420845569896693674208644701928]

"""
m * Q[0] + r0 * R[0] + s0 * S[0] = C[0]
m + r0 * R[0] * Q[0]^-1 + s0 * S[0] * Q[0]^-1 = C[0] * Q[0]^-1
m + r1 * R[1] * Q[1]^-1 + s1 * S[1] * Q[1]^-1 = C[1] * Q[1]^-1
r0 * R[0] * Q[0]^-1 + s0 * S[0] * Q[0]^-1 - r1 * R[1] * Q[1]^-1 - s1 * S[1] * Q[1]^-1 = C[0] * Q[0]^-1 - C[1] * Q[1]^-1
"""
Q = vector(GF(p), Q)
A = Matrix([
  [1, 0, 0, 0, 0, int(R[0] * Q[0] ** -1)],
  [0, 1, 0, 0, 0, int(S[0] * Q[0] ** -1)],
  [0, 0, 1, 0, 0, int(R[1] * Q[1] ** -1)],
  [0, 0, 0, 1, 0, int(S[1] * Q[1] ** -1)],
  [0, 0, 0, 0, 1, -p],
  [0, 0, 0, 0, 0, int(C[0] * Q[0] ** -1 - C[1] * Q[1] ** -1)],
])

print(A.LLL()[0])
# (-2638621544, -3219364802, 3791125439, 2479984130, -136018362, 0)

r1 = 3791125439
s1 = 2479984130
m = (C[1] - s1 * S[1] - r1 * R[1]) * Q[1] ** -1
print(long_to_bytes(int(m)).decode())
